# membrane_AA_simulation
1. Orient protein "OPM membranes" [PPM2] [https://opm.phar.umich.edu/]



a. I was not able to get any "aligned" structure. Anything wrong with my receptors?

b. How to align protein not displaying full sequence identity to a reference with VMD?

* I guess multiseq will move all proteins

* RMSD aligned on VMD is hard to use when different proteins are involved



=> For now I'll use the two protein_prep.pdb (for 7E2Y and AF models made by Mohd) as reference to align the MT model.



In any case, from here, separate ligand and protein structures.



grep "MOL" XXX.pdb > ligand.pdb 

grep -v "MOL" XXX.pdb > protein.pdb 



Check protein structures with 



source /etc/modules.sh

module load amber20

source $AMBERHOME/amber.sh



 pdb4amber -i *pdb –o *pdb 





pdb4amber protein_prep.pdb -o protein_ok.pdb



2. Parametrize the ligand [already done by Mohd] 

=> I'll just use the parameters generated by Mohd



Commands:



antechamber -i ligand.pdb -fi pdb -o ligand.mol2 -fo mol2 -c bcc -s 2 -rn MOL -at gaff2 

parmchk2 -i ligand.mol2 -f mol2 -o missing_gaff2.frcmod -at gaff2 

tleap -f convert.leap ####though tleap can automatically generate all parameter at once, but it's better to parameterize ligand separately,a/c to my experience 





 *********convert.leap********************* 

source leaprc.gaff2 

loadamberparams missing_gaff2.frcmod 

ligand=loadmol2 ligand.mol2 

saveoff ligand ligand.off 

quit 



3.  Use packmol-memgen





packmol-memgen --pdb protein_ok.pdb --lipids SDPC:POPC:CHL1 --ratio 7:7:6 --preoriented --salt --salt_c Na+ --saltcon 0.15 --dist 10 --dist_wat 15 --notprotonate



Where: protein_ok.pdb is the file coming from pdb4amber

Membrane composition and salt concentration is coming from papers like this one: https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1002473#s4 [not the only one using those settings]



#Original command by Attilio

#packmol-memgen -p ${pdb_move} --salt --salt_c K+ --saltcon 0.15 --salt_override --parametrize --ffwat opc --ffprot ff19SB --gaff2 --ligand_param ../mol.frcmod:../mol.off --lipids POPE:POPG --ratio 2:1 --dist 17.5 --dist_wat 17.5 --keepligs --n_ter in --random --movebadrandom --lip_offset 1.1



4. ./shift_membrane.py -i protein_ok.pdb -m bilayer_protein_ok.pdb -o membrane.pdb [this python script needs to be in the working dir]



Take the PBC coordinates: e.g. Box X, Y, Z: 77.728 78.118 108.024

And use them in the leap script:



#source /usr/local/amber18/dat/leap/cmd/oldff/leaprc.ff99SB 

#source /usr/local/amber18/dat/leap/cmd/leaprc.water.tip3p 

#source /usr/local/amber18/dat/leap/cmd/leaprc.lipid14

source /usr/local/amber20/dat/leap/cmd/leaprc.gaff2

source /usr/local/amber20/dat/leap/cmd/leaprc.protein.ff19SB

source /usr/local/amber20/dat/leap/cmd/leaprc.water.opc

#source /usr/local/amber20/dat/leap/parm/gaff2.dat



#source /usr/local/amber20/dat/leap/parm/leaprc.protein.ff19SB

#source /usr/local/amber20/dat/leap/cmd/leaprc.protein.ff19SB

#source /usr/local/amber20/dat/leap/parm/frcmod.opc

#source /usr/local/amber20/dat/leap/parm/leaprc.gaff2 

source /home/mathar/andrea/leaprc.lipid21 



#loadamberparams frcmod.ionsjc_tip3p

loadamberparams frcmod.ions1lm_126_iod_opc 

loadamberparams ligand.off 

loadamberparams missing_gaff2.frcmod

drug = loadmol2 ./ligand1.mol2 

receptor = loadpdb ./protein_ok.pdb  

membrane = loadpdb ./membrane.pdb 

system=combine{ receptor membrane drug } 

set system box {89.160 89.160 143.030}  # <- HERE THE COORDINATES TAKEN FROM “shift membrane”.

saveoff system system.lib

saveamberparm system system.prmtop system.inpcrd 

savepdb system system.pdb 

quit



Note, if the *.py script doesn’t work, try to get the coordinates from the “FORCED” bilayer file, but then create the membrane starting not from the forced one.



Note 2: tleap needs the lipid21 files (they are at least 2, the .lib and the .dat one) in its working dir, together with “missing_gaff2.frcmod” and all the ligand files (such as ligand*.off/mol2). So, check carefully if everything is in the right place before using “teap -f script.leap”



5. Use the following commands, in a script (parmed -i script) for HmassRep.



parm system.prmtop

HMassRepartition

outparm system.hmass.prmtop

quit



6. Run the simulations. Note that some Attilio’s scripts already "customized" for these receptors are in directories like: octopus:home/abasciu/PharmCADD_complexes_membrane/A02-MT/MD

